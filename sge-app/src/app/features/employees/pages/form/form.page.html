<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/employees/list"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ isEditMode ? 'Editar' : 'Nuevo' }} Empleado</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <ion-card>
      <ion-card-header>
        <ion-card-title>Informaci칩n del Empleado</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <ion-item>
          <ion-label position="stacked">Nombre Completo *</ion-label>
          <ion-input
            type="text"
            formControlName="fullName"
            placeholder="Ingrese el nombre completo">
          </ion-input>
        </ion-item>
        @if (fullName?.invalid && fullName?.touched) {
        <div class="error-message">
          @if (fullName?.errors?.['required']) {
          <small>El nombre es requerido</small>
          }
          @if (fullName?.errors?.['maxlength']) {
          <small>M치ximo 120 caracteres</small>
          }
        </div>
        }

        <ion-item>
          <ion-label position="stacked">Cargo *</ion-label>
          <ion-input
            type="text"
            formControlName="role"
            placeholder="Ingrese el cargo">
          </ion-input>
        </ion-item>
        @if (role?.invalid && role?.touched) {
        <div class="error-message">
          @if (role?.errors?.['required']) {
          <small>El cargo es requerido</small>
          }
          @if (role?.errors?.['maxlength']) {
          <small>M치ximo 80 caracteres</small>
          }
        </div>
        }

        <ion-item>
          <ion-label position="stacked">Fecha de Contrataci칩n *</ion-label>
          <ion-input
            type="date"
            formControlName="hireDate">
          </ion-input>
        </ion-item>
        @if (hireDate?.invalid && hireDate?.touched) {
        <div class="error-message">
          @if (hireDate?.errors?.['required']) {
          <small>La fecha es requerida</small>
          }
        </div>
        }

        <ion-item>
          <ion-label position="stacked">Salario *</ion-label>
          <ion-input
            type="number"
            formControlName="salary"
            placeholder="0.00">
          </ion-input>
        </ion-item>
        @if (salary?.invalid && salary?.touched) {
        <div class="error-message">
          @if (salary?.errors?.['required']) {
          <small>El salario es requerido</small>
          }
          @if (salary?.errors?.['min']) {
          <small>El salario debe ser mayor o igual a 0</small>
          }
        </div>
        }

        <ion-item>
          <ion-label position="stacked">Departamento *</ion-label>
          <ion-select
            formControlName="departmentId"
            placeholder="Seleccione un departamento">
            @for (dept of departments; track dept.id) {
            <ion-select-option [value]="dept.id">
              {{ dept.name }}
            </ion-select-option>
            }
          </ion-select>
        </ion-item>
        @if (departmentId?.invalid && departmentId?.touched) {
        <div class="error-message">
          @if (departmentId?.errors?.['required']) {
          <small>El departamento es requerido</small>
          }
        </div>
        }
      </ion-card-content>
    </ion-card>

    <div class="button-group">
      <ion-button
        expand="block"
        type="submit"
        [disabled]="loading || form.invalid">
        @if (loading) {
        <ion-spinner name="crescent"></ion-spinner>
        }
        @if (!loading) {
        <span>{{ isEditMode ? 'Actualizar' : 'Crear' }}</span>
        }
      </ion-button>

      <ion-button
        expand="block"
        color="medium"
        type="button"
        (click)="onCancel()"
        [disabled]="loading">
        Cancelar
      </ion-button>
    </div>
  </form>
</ion-content>